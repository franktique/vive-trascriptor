<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whisper Transcriber</title>
    <link rel="stylesheet" href="overlay.css">
</head>
<body>
    <div class="overlay-container">
        <div class="drag-handle">
            <div class="drag-area"></div>
            <div class="recording-controls">
                <button id="start-recording-btn" class="recording-btn" title="Start Recording">‚ñ∂Ô∏è</button>
                <button id="stop-recording-btn" class="recording-btn" title="Stop Recording" disabled>‚èπÔ∏è</button>
                <button id="pause-recording-btn" class="recording-btn" title="Pause Recording" disabled>‚è∏Ô∏è</button>
            </div>
            <div class="controls">
                <button id="advanced-audio-btn" title="Advanced Audio Settings">üéöÔ∏è</button>
                <button id="toggle-sidebar-btn" title="Settings">‚öôÔ∏è</button>
                <button id="minimize-btn" title="Minimize">‚àí</button>
                <button id="close-btn" title="Close">√ó</button>
            </div>
        </div>

        <div class="main-content">
            <div class="transcript-container">
                <div id="transcript-display">
                    <div class="status-indicator">
                        <span id="status-text">Ready to transcribe</span>
                        <div id="recording-indicator" class="hidden"></div>
                    </div>
                    <div id="transcript-text"></div>
                    <div id="current-text" class="current-transcription"></div>
                </div>
            </div>

            <div class="resize-handles">
                <div class="resize-handle resize-right"></div>
                <div class="resize-handle resize-bottom"></div>
                <div class="resize-handle resize-bottom-right"></div>
            </div>
        </div>

        <!-- Settings Sidebar -->
        <div class="sidebar" id="settings-sidebar">
            <div class="sidebar-header">
                <h2>Settings</h2>
                <button id="close-sidebar-btn" class="close-sidebar-btn" title="Close Settings">√ó</button>
            </div>

            <div class="sidebar-content">
                <!-- Appearance Section -->
                <div class="section">
                    <h3>Appearance</h3>

                    <div class="setting-group">
                        <label for="theme-select">Theme</label>
                        <select id="theme-select">
                            <option value="light">Light Theme</option>
                            <option value="dark">Dark Theme</option>
                            <option value="system">Follow System</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <label for="opacity-slider">Transparency</label>
                        <div class="slider-container">
                            <input type="range" id="opacity-slider" min="0.1" max="1" step="0.05" value="0.8">
                            <span id="opacity-value">80%</span>
                        </div>
                    </div>

                    <div class="setting-group">
                        <label for="font-size">Font Size</label>
                        <div class="slider-container">
                            <input type="range" id="font-size" min="12" max="24" step="1" value="16">
                            <span id="font-size-value">16px</span>
                        </div>
                    </div>
                </div>

                <!-- Audio Settings Section -->
                <div class="section">
                    <h3>Audio Settings</h3>

                    <div class="setting-group">
                        <label for="microphone-select">Microphone</label>
                        <select id="microphone-select">
                            <option value="default">Default Microphone</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <label for="sensitivity">Sensitivity</label>
                        <div class="slider-container">
                            <input type="range" id="sensitivity" min="0.1" max="1" step="0.1" value="0.5">
                            <span id="sensitivity-value">50%</span>
                        </div>
                    </div>

                    <div class="audio-level">
                        <label>Audio Level</label>
                        <div class="level-meter">
                            <div class="level-bar" id="audio-level-bar"></div>
                        </div>
                    </div>
                </div>

                <!-- Whisper Settings Section -->
                <div class="section">
                    <h3>Whisper Settings</h3>

                    <div class="setting-group">
                        <label for="model-select">Model</label>
                        <select id="model-select">
                            <option value="tiny.en">Tiny EN (39 MB) - English only, fastest</option>
                            <option value="base.en" selected>Base EN (74 MB) - English only, balanced</option>
                            <option value="small.en">Small EN (244 MB) - English only, good accuracy</option>
                            <option value="medium.en">Medium EN (769 MB) - English only, better accuracy</option>
                            <option value="large">Large (1550 MB) - Multilingual, best accuracy</option>
                        </select>
                    </div>

                    <div id="model-status" class="setting-group" style="display: none;">
                        <label>Model Status</label>
                        <div id="model-info" class="status-display">
                            <span id="model-status-text">Not Downloaded</span>
                            <button id="download-model-btn" class="primary-button" style="font-size: 12px; padding: 6px 12px;">Download</button>
                        </div>

                        <div id="download-progress" style="display: none; margin-top: 8px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                                <span id="download-status" style="font-size: 12px; color: var(--text-muted);">Downloading...</span>
                                <span id="download-speed" style="font-size: 12px; color: var(--text-muted);"></span>
                            </div>
                            <div class="level-meter" style="height: 4px;">
                                <div id="download-progress-bar" class="level-bar" style="background: var(--accent-primary); width: 0%;"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                                <span id="download-percent" style="font-size: 11px; color: var(--text-muted);">0%</span>
                                <span id="download-eta" style="font-size: 11px; color: var(--text-muted);"></span>
                            </div>
                        </div>
                    </div>

                    <div class="setting-group">
                        <label for="language-select">Language</label>
                        <select id="language-select">
                            <option value="en" selected>English</option>
                            <option value="auto">Auto-detect</option>
                        </select>
                    </div>
                </div>

                <!-- Export Section -->
                <div class="section">
                    <h3>Export</h3>

                    <div class="button-group">
                        <button id="save-transcript" class="primary-button">
                            <span class="icon">üíæ</span>
                            Save Transcript
                        </button>

                        <button id="clear-transcript" class="warning-button">
                            <span class="icon">üóëÔ∏è</span>
                            Clear Transcript
                        </button>
                    </div>

                    <div class="setting-group">
                        <label for="export-format">Export Format</label>
                        <select id="export-format">
                            <option value="srt" selected>SRT (SubRip)</option>
                            <option value="txt">Plain Text</option>
                            <option value="json">JSON</option>
                        </select>
                    </div>
                </div>

                <!-- Statistics Section -->
                <div class="section">
                    <h3>Statistics</h3>

                    <div class="stats-grid">
                        <div class="stat">
                            <div class="stat-value" id="total-words">0</div>
                            <div class="stat-label">Words</div>
                        </div>

                        <div class="stat">
                            <div class="stat-value" id="total-time">00:00</div>
                            <div class="stat-label">Duration</div>
                        </div>

                        <div class="stat">
                            <div class="stat-value" id="avg-confidence">0%</div>
                            <div class="stat-label">Avg Confidence</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Advanced Audio Settings Sidebar -->
    <div class="sidebar" id="advanced-audio-sidebar">
        <div class="sidebar-header">
            <h2>Advanced Audio</h2>
            <button id="close-advanced-audio-btn" class="close-sidebar-btn" title="Close Advanced Audio">√ó</button>
        </div>

        <div class="sidebar-content">
            <div id="audio-parameters-container">
                    <!-- 1. Silence Threshold (Critical Impact) -->
                    <div class="audio-parameter-group critical-impact">
                        <div class="parameter-header">
                            <div class="parameter-title">
                                <label>Silence Threshold</label>
                                <span class="impact-badge">‚ö†Ô∏è Critical</span>
                            </div>
                            <button type="button" class="reset-btn" data-param="silenceThreshold" title="Reset to default (-40 dB)">‚Üª Reset</button>
                        </div>
                        <p class="parameter-description">Skip audio chunks below this volume level</p>
                        <div class="slider-container">
                            <span class="slider-min">-60 dB</span>
                            <input type="range" id="silence-threshold-slider" class="audio-slider" min="-60" max="-10" step="2" value="-40" data-param="silenceThreshold" data-unit="dB">
                            <span class="slider-max">-10 dB</span>
                        </div>
                        <div class="slider-value-display">
                            <span id="silence-threshold-value">-40 dB</span>
                        </div>
                    </div>

                    <!-- 2. Normalization Target (Critical Impact) -->
                    <div class="audio-parameter-group critical-impact">
                        <div class="parameter-header">
                            <div class="parameter-title">
                                <label>Normalization Target</label>
                                <span class="impact-badge">‚ö†Ô∏è Critical</span>
                            </div>
                            <button type="button" class="reset-btn" data-param="normalizationTarget" title="Reset to default (-20 dB)">‚Üª Reset</button>
                        </div>
                        <p class="parameter-description">Target audio level for normalization</p>
                        <div class="slider-container">
                            <span class="slider-min">-30 dB</span>
                            <input type="range" id="normalization-target-slider" class="audio-slider" min="-30" max="-10" step="1" value="-20" data-param="normalizationTarget" data-unit="dB">
                            <span class="slider-max">-10 dB</span>
                        </div>
                        <div class="slider-value-display">
                            <span id="normalization-target-value">-20 dB</span>
                        </div>
                    </div>

                    <!-- 3. Confidence Threshold (Critical Impact) -->
                    <div class="audio-parameter-group critical-impact">
                        <div class="parameter-header">
                            <div class="parameter-title">
                                <label>Confidence Threshold</label>
                                <span class="impact-badge">‚ö†Ô∏è Critical</span>
                            </div>
                            <button type="button" class="reset-btn" data-param="confidenceThreshold" title="Reset to default (0.6)">‚Üª Reset</button>
                        </div>
                        <p class="parameter-description">Minimum confidence to display transcription results</p>
                        <div class="slider-container">
                            <span class="slider-min">0.3</span>
                            <input type="range" id="confidence-threshold-slider" class="audio-slider" min="0.3" max="0.9" step="0.05" value="0.6" data-param="confidenceThreshold" data-unit="">
                            <span class="slider-max">0.9</span>
                        </div>
                        <div class="slider-value-display">
                            <span id="confidence-threshold-value">60%</span>
                        </div>
                    </div>

                    <!-- 4. High-Pass Filter Cutoff (Medium Impact) -->
                    <div class="audio-parameter-group medium-impact">
                        <div class="parameter-header">
                            <div class="parameter-title">
                                <label>High-Pass Filter Cutoff</label>
                                <span class="impact-badge">üü° Medium</span>
                            </div>
                            <button type="button" class="reset-btn" data-param="highPassCutoff" title="Reset to default (300 Hz)">‚Üª Reset</button>
                        </div>
                        <p class="parameter-description">Remove frequencies below this Hz (noise filtering)</p>
                        <div class="slider-container">
                            <span class="slider-min">100 Hz</span>
                            <input type="range" id="high-pass-cutoff-slider" class="audio-slider" min="100" max="800" step="50" value="300" data-param="highPassCutoff" data-unit="Hz">
                            <span class="slider-max">800 Hz</span>
                        </div>
                        <div class="slider-value-display">
                            <span id="high-pass-cutoff-value">300 Hz</span>
                        </div>
                    </div>

                    <!-- 5. AGC Target Level (Medium Impact) -->
                    <div class="audio-parameter-group medium-impact">
                        <div class="parameter-header">
                            <div class="parameter-title">
                                <label>AGC Target Level</label>
                                <span class="impact-badge">üü° Medium</span>
                            </div>
                            <button type="button" class="reset-btn" data-param="agcTargetLevel" title="Reset to default (-20 dB)">‚Üª Reset</button>
                        </div>
                        <p class="parameter-description">Target level for automatic gain control</p>
                        <div class="slider-container">
                            <span class="slider-min">-30 dB</span>
                            <input type="range" id="agc-target-level-slider" class="audio-slider" min="-30" max="-10" step="1" value="-20" data-param="agcTargetLevel" data-unit="dB">
                            <span class="slider-max">-10 dB</span>
                        </div>
                        <div class="slider-value-display">
                            <span id="agc-target-level-value">-20 dB</span>
                        </div>
                    </div>

                    <!-- 6. Max Parallel Chunks (Medium Impact) -->
                    <div class="audio-parameter-group medium-impact">
                        <div class="parameter-header">
                            <div class="parameter-title">
                                <label>Max Parallel Chunks</label>
                                <span class="impact-badge">üü° Medium</span>
                            </div>
                            <button type="button" class="reset-btn" data-param="maxParallelChunks" title="Reset to default (2)">‚Üª Reset</button>
                        </div>
                        <p class="parameter-description">Number of audio chunks to process simultaneously</p>
                        <div class="slider-container">
                            <span class="slider-min">1</span>
                            <input type="range" id="max-parallel-chunks-slider" class="audio-slider" min="1" max="4" step="1" value="2" data-param="maxParallelChunks" data-unit="">
                            <span class="slider-max">4</span>
                        </div>
                        <div class="slider-value-display">
                            <span id="max-parallel-chunks-value">2</span>
                        </div>
                    </div>

                    <!-- 7. VAD Energy Threshold (Low-Medium Impact) -->
                    <div class="audio-parameter-group low-impact">
                        <div class="parameter-header">
                            <div class="parameter-title">
                                <label>VAD Energy Threshold</label>
                                <span class="impact-badge">üü° Low-Med</span>
                            </div>
                            <button type="button" class="reset-btn" data-param="vadEnergyThreshold" title="Reset to default (-35 dB)">‚Üª Reset</button>
                        </div>
                        <p class="parameter-description">Minimum energy level for voice activity detection</p>
                        <div class="slider-container">
                            <span class="slider-min">-40 dB</span>
                            <input type="range" id="vad-energy-threshold-slider" class="audio-slider" min="-40" max="-20" step="1" value="-35" data-param="vadEnergyThreshold" data-unit="dB">
                            <span class="slider-max">-20 dB</span>
                        </div>
                        <div class="slider-value-display">
                            <span id="vad-energy-threshold-value">-35 dB</span>
                        </div>
                    </div>
                </div>
            </div>

                <!-- Control Buttons -->
                <div class="button-group" style="margin-top: 16px;">
                    <button type="button" id="advanced-reset-all-btn" class="primary-button">‚Üª Reset All to Defaults</button>
                </div>
            </div>
        </div>
    </div>

    <script src="overlay.js"></script>
</body>
</html>